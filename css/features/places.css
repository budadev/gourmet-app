/* =============================
   Places Feature Styles
   ============================= */

.place-selector-section {
  margin-top: 16px;
  padding-top: 16px;
  border-top: 2px solid var(--border-light);
}

.place-selector-section > label {
  display: block;
  margin-bottom: 8px;
  font-weight: 600;
  color: var(--text-primary);
}

.place-search-wrapper {
  position: relative;
  display: flex;
  gap: 0;
  margin-bottom: 8px;
}

.place-search-input {
  flex: 1;
  padding: 12px 48px 12px 16px;
  background: var(--bg-secondary);
  border: 2px solid var(--border-light);
  border-radius: 12px;
  color: var(--text-primary);
  font-size: 15px;
  outline: none;
  transition: all 0.2s ease;
}

.place-search-input:focus {
  border-color: var(--primary);
  background: var(--bg-primary);
}

.place-add-btn {
  position: absolute;
  right: 8px;
  top: 50%;
  transform: translateY(-50%);
  width: 32px;
  height: 32px;
  background: #10b981;
  border: none;
  border-radius: 50%;
  color: white;
  font-size: 20px;
  font-weight: 300;
  cursor: pointer;
  transition: all 0.2s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 2px 4px rgba(16, 185, 129, 0.2);
}

.place-add-btn:hover {
  background: #059669;
  transform: translateY(-50%) scale(1.05);
  box-shadow: 0 4px 8px rgba(16, 185, 129, 0.3);
}

.place-add-btn:active {
  transform: translateY(-50%) scale(0.95);
}

.place-add-btn.hidden {
  display: none;
}

.place-search-results {
  position: absolute;
  top: calc(100% + 4px);
  left: 0;
  right: 0;
  background: var(--bg-secondary);
  border: 2px solid var(--border-light);
  border-radius: 12px;
  max-height: 240px;
  overflow-y: auto;
  z-index: 1000;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
}

.place-search-results.hidden {
  display: none;
}

.place-search-item {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 12px 16px;
  cursor: pointer;
  transition: background 0.2s ease;
  border-bottom: 1px solid var(--border-light);
}

.place-search-item:last-child {
  border-bottom: none;
}

.place-search-item:hover {
  background: var(--bg-primary);
}

.place-search-item.selected {
  background: rgba(139, 92, 246, 0.1);
}

.place-search-item-icon {
  font-size: 18px;
}

.place-search-item-name {
  flex: 1;
  color: var(--text-primary);
  font-size: 15px;
}

.place-search-item-check {
  color: var(--primary);
  font-size: 18px;
  font-weight: bold;
}

.place-search-empty {
  padding: 16px;
  text-align: center;
  color: var(--text-muted);
  font-size: 14px;
}

.selected-places {
  margin-top: 12px;
}

.empty-places {
  padding: 12px;
  text-align: center;
  color: var(--text-muted);
  font-size: 14px;
  font-style: italic;
  background: var(--bg-secondary);
  border-radius: 8px;
}

.place-list {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.place-tag {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 8px 12px;
  background: var(--bg-secondary);
  border: 2px solid var(--border-light);
  border-radius: 20px;
  font-size: 14px;
  transition: all 0.2s ease;
}

.place-tag:hover {
  border-color: var(--primary);
  background: rgba(139, 92, 246, 0.1);
}

.place-tag-icon {
  font-size: 16px;
}

.place-tag-name {
  color: var(--text-primary);
  font-weight: 500;
}

.place-tag-remove {
  background: none;
  border: none;
  color: var(--text-muted);
  font-size: 20px;
  line-height: 1;
  cursor: pointer;
  padding: 0;
  width: 20px;
  height: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  transition: all 0.2s ease;
}

.place-tag-remove:hover {
  background: rgba(239, 68, 68, 0.2);
  color: #ef4444;
}

/* Places in details view */
.place-badge {
  display: inline-block;
  padding: 6px 12px;
  background: var(--bg-secondary);
  border: 1px solid var(--border-light);
  border-radius: 16px;
  font-size: 14px;
  margin-right: 8px;
  margin-bottom: 8px;
  color: var(--text-primary);
  transition: all 0.2s ease;
}

.place-badge.clickable {
  cursor: pointer;
}

.place-badge.clickable:hover {
  background: rgba(139, 92, 246, 0.15);
  border-color: var(--primary);
  transform: translateY(-1px);
  box-shadow: 0 2px 6px rgba(139, 92, 246, 0.2);
}

.place-badge.clickable:active {
  transform: translateY(0);
}

/* Make the dropdown position work within modal */
.modal-body .place-search-wrapper {
  position: relative;
}

.modal-body .place-search-results {
  position: absolute;
  z-index: 10001;
}

/* Sticky search in places modal */
#placesModal .search-wrapper {
  background: white;
}

#placesModal .modal-content {
  /* ensure the content container does not create its own scrollbar; the modal-body will be the single scroller */
  overflow: hidden;
}

#placesModal .modal-body {
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
  position: relative; /* keeps any absolutely positioned children positioned relative to modal body */
}

/* Let the modal body be the single scroll container. Remove internal list scrolling
   so items use the entire modal height when footer is hidden, and the body
   will automatically shrink when the footer appears (avoids double scrollbars). */
.places-list {
  /* no internal max-height/overflow here; modal-body handles scrolling */
  display: flex;
  flex-direction: column;
  gap: 12px;
}

/* Disabled merge button */
#mergePlacesBtn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* Places management page styles */
.places-list {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.places-list-item {
  display: flex;
  align-items: stretch;
  padding: 0;
  border: 1.5px solid var(--border-light);
  border-radius: 18px;
  background: #fff;
  box-shadow: 0 6px 24px rgba(0,0,0,0.08);
  position: relative;
  transition: background 0.2s, border-color 0.2s, box-shadow 0.2s, transform 0.2s;
}

.places-list-item::before {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: inherit;
  pointer-events: none;
  opacity: 0;
  transition: opacity var(--transition-fast) var(--ease);
  background: linear-gradient(120deg, rgba(59, 130, 246, .1), rgba(16, 185, 129, .1));
}

.places-list-item:hover {
  border-color: var(--primary-light);
  background: var(--card-hover);
  transform: translateY(-3px);
  box-shadow: var(--shadow-md);
}

.places-list-item:hover::before {
  opacity: 1;
}

.places-list-item-content {
  display: flex;
  flex-direction: column;
  justify-content: center;
  width: 100%;
  padding: 28px 28px 20px 28px;
  background: transparent;
  border-radius: 18px;
  box-shadow: none;
  margin-bottom: 0;
}

.places-list-item-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 10px;
  gap: 18px;
}

.places-list-item-name {
  font-size: 18px;
  font-weight: 700;
  color: var(--text-primary);
  flex: 1;
  line-height: 1.2;
  font-family: inherit;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.places-list-item-menu-btn {
  background: none;
  border: none;
  font-size: 20px;
  color: var(--text-muted);
  cursor: pointer;
  padding: 2px 10px 2px 10px;
  margin-left: 12px;
  border-radius: 50%;
  transition: background 0.15s, color 0.15s;
  display: flex;
  align-items: center;
  height: 32px;
  line-height: 1;
  font-weight: 400;
}
.places-list-item-menu-btn:hover {
  background: var(--bg-secondary);
  color: var(--primary);
}

.places-list-item-usage {
  font-size: 15px;
  color: var(--text-secondary);
  margin-bottom: 0;
  margin-left: 2px;
  font-family: inherit;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.places-list-item-menu {
  position: absolute;
  right: 20px;
  top: 100%;
  background: white;
  border: 1px solid var(--border-light);
  border-radius: 8px;
  box-shadow: var(--shadow-lg);
  z-index: 10000;
  min-width: 160px;
  display: flex;
  flex-direction: column;
}

.places-menu-option {
  background: none;
  border: none;
  padding: 12px 16px;
  text-align: left;
  font-size: 16px;
  color: var(--text-primary);
  cursor: pointer;
  transition: background 0.2s ease;
  border-bottom: 1px solid var(--border-light);
}

.places-menu-option:last-child {
  border-bottom: none;
}

.places-menu-option:hover {
  background: var(--bg-secondary);
}

.form-group {
  margin-bottom: 16px;
}

.form-group label {
  display: block;
  margin-bottom: 8px;
  font-weight: 600;
}

.form-group input[type="text"] {
  width: 100%;
  border: 1px solid var(--border);
  background: var(--bg-secondary);
  border-radius: var(--radius-lg);
  padding: 14px 16px;
  font-size: 15px;
  box-shadow: inset 0 1px 2px rgba(0, 0, 0, .04);
  transition: border var(--transition-fast) var(--ease), background var(--transition-fast) var(--ease), box-shadow var(--transition-fast) var(--ease);
  font-family: inherit;
  touch-action: manipulation;
}

.form-group input[type="text"]:focus {
  border-color: var(--primary);
  background: var(--card);
  box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.15);
}

.checkbox-label {
  display: flex;
  align-items: center;
  gap: 8px;
  cursor: pointer;
}

.checkbox-label input {
  margin: 0;
}

/* Ensure menus and their options receive pointer events even when moved into body */
.places-list-item-menu,
.places-menu-option {
  pointer-events: auto;
}

/* When menu is moved into body, keep same visual style */
.places-list-item-menu {
  background: var(--card);
}

/* Larger, modern styled checkbox for merge mode */
.place-checkbox {
  width: 22px;
  height: 22px;
  accent-color: var(--primary, #2563eb);
  transform: scale(1.3);
  cursor: pointer;
  margin: 0;
  border-radius: 6px;
  box-shadow: 0 1px 2px rgba(0,0,0,0.04);
}

.place-checkbox:focus {
  outline: 2px solid var(--primary, #2563eb);
  outline-offset: 2px;
}

/* Inline place editor popup */
.inline-place-editor {
  min-width: 220px;
  max-width: 320px;
  background: var(--bg-secondary);
  border: 1.5px solid var(--border-light);
  border-radius: 12px;
  padding: 10px;
  box-shadow: 0 8px 24px rgba(0,0,0,0.12);
  display: flex;
  gap: 8px;
  align-items: center;
}

.inline-place-input {
  flex: 1;
  padding: 8px 10px;
  border: 1px solid var(--border-light);
  border-radius: 8px;
  background: var(--bg-primary);
  color: var(--text-primary);
  font-size: 14px;
  outline: none;
}

.inline-place-actions {
  display: flex;
  gap: 6px;
  margin-left: 6px;
}

.inline-place-save.btn.primary {
  padding: 6px 10px;
  font-size: 13px;
}

.inline-place-cancel.btn {
  padding: 6px 8px;
  font-size: 13px;
  background: transparent;
  border: 1px solid var(--border-light);
  border-radius: 8px;
}

.inline-place-editor input:focus {
  border-color: var(--primary);
}

/* Backdrop for inline editor: darken background and center the popup */
.inline-place-backdrop {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.72); /* slightly stronger */
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 14000; /* ensure above other overlays */
  padding: 20px; /* spacing on small screens */
  -webkit-overflow-scrolling: touch;
}

/* Ensure the editor itself is centered and doesn't stretch full width */
.inline-place-backdrop .inline-place-editor {
  position: relative; /* keeps it centered inside backdrop */
  max-width: 560px;
  width: 100%;
  box-sizing: border-box;
  margin: 0 auto;
  padding: 16px 18px;
  display: flex;
  gap: 12px;
  align-items: center;
  border-radius: 14px;
  background: var(--card); /* use solid surface color */
  color: var(--text-primary);
  border: 1px solid rgba(0,0,0,0.08);
  box-shadow: 0 18px 40px rgba(0,0,0,0.6);
}

.inline-place-backdrop .inline-place-editor .inline-place-input {
  padding: 10px 12px;
  font-size: 15px;
  background: var(--bg-secondary);
  border: 1px solid var(--border);
  color: var(--text-primary);
  border-radius: 10px;
}

.inline-place-backdrop .inline-place-editor .inline-place-actions {
  display: flex;
  gap: 8px;
  align-items: center;
}

.inline-place-backdrop .inline-place-editor .inline-place-save.btn.primary {
  padding: 8px 14px;
  font-size: 14px;
}

.inline-place-backdrop .inline-place-editor .inline-place-cancel.btn {
  padding: 7px 12px;
  font-size: 14px;
}

/* Ensure buttons don't show odd white outline on some browsers */
.inline-place-backdrop .inline-place-editor .btn:focus {
  outline: none;
  box-shadow: 0 0 0 4px rgba(59,130,246,0.18);
}

@media (max-width:480px){
  .inline-place-backdrop .inline-place-editor{
    padding: 12px;
    gap: 8px;
  }
  .inline-place-backdrop .inline-place-editor .inline-place-input{
    font-size: 14px;
  }
}
