<!-- =============================
File: index.html
Purpose: GourmetApp — installable PWA that scans barcodes, stores items in local IndexedDB, supports search, optional lookup via Open Food Facts
How to use:
 1) Save files as shown below (index.html, sw.js, manifest.webmanifest).
 2) Serve over HTTPS (required for camera). Any static host works (Cloudflare Pages, GitHub Pages, Netlify, simple HTTPS server).
 3) On iPhone: open in Safari → Share → Add to Home Screen. First launch will ask for camera permission when scanning.
================================ -->
<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover" />
    <title>GourmetApp</title>
    <meta name="theme-color" content="#111827" />
    <meta name="description" content="Barcode scanner and item manager for gourmet products" />

    <!-- iOS-specific meta tags for better PWA support -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="apple-mobile-web-app-title" content="GourmetApp" />

    <link rel="manifest" href="./manifest.webmanifest" />
    <link rel="apple-touch-icon" href="icons/icon-192.png" />

    <!-- CSS Modules -->
    <link rel="stylesheet" href="css/variables.css" />
    <link rel="stylesheet" href="css/base.css" />
    <link rel="stylesheet" href="css/layout.css" />
    <link rel="stylesheet" href="css/components.css" />
    <link rel="stylesheet" href="css/modals.css" />
    <link rel="stylesheet" href="css/features/search.css" />
    <link rel="stylesheet" href="css/features/items.css" />
    <link rel="stylesheet" href="css/features/ratings.css" />
    <link rel="stylesheet" href="css/features/photos.css" />
    <link rel="stylesheet" href="css/features/pairings.css" />
</head>
<body>
<header>
    <div class="search-wrapper">
        <label for="searchInput" class="visually-hidden">Search items</label>
        <input id="searchInput" type="text" placeholder="Search by name, notes, or barcode…"/>
        <button class="barcode-btn" id="barcodeScanBtn" title="Scan barcode">
            <img src="icons/barcode.png" alt="Scan barcode" />
        </button>
    </div>
</header>

<main>
    <!-- Scanner section (shown in modal) -->
    <div id="scannerModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Scan Barcode</h2>
                <button class="close-btn" id="closeScannerBtn">×</button>
            </div>
            <div class="modal-body">
                <div style="position:relative">
                    <video id="preview" playsinline></video>
                </div>
                <div class="muted" style="margin-top:8px;text-align:center" id="scanHint"></div>
            </div>
            <div class="modal-footer">
                <div class="row" style="margin:0">
                    <button class="btn" id="cancelScannerBtn">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Item details modal -->
    <div id="detailsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Item Details</h2>
                <button class="close-btn" id="closeDetailsBtn">×</button>
            </div>
            <div class="modal-body">
                <div id="detailsContent"></div>
            </div>
            <div class="modal-footer">
                <div class="row" style="margin:0" id="detailsButtons">
                    <!-- Buttons will be dynamically inserted here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Editor modal -->
    <div id="editorModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="editorTitle">Add Item</h2>
                <button class="close-btn" id="closeEditorBtn">×</button>
            </div>
            <div class="modal-body">
                <div id="editorFields">
                    <!-- Dynamic fields will be generated here -->
                </div>
            </div>
            <div class="modal-footer">
                <div class="row" style="margin:0">
                    <button class="btn primary" id="saveBtn">Save</button>
                    <button class="btn" id="cancelEditorBtn">Cancel</button>
                </div>
                <div class="muted" style="margin-top:8px" id="status"></div>
            </div>
        </div>
    </div>

    <!-- Items list -->
    <div id="results" class="list"></div>
</main>

<!-- Floating add button -->
<button class="fab" id="fabBtn" title="Add new item">+</button>

<!-- Photo viewer modal -->
<div id="photoModal" class="photo-modal">
    <button class="close-btn" id="closePhotoBtn">×</button>
    <img id="photoModalImg" src="" alt="Full size photo" />
</div>

<!-- Pairing selector modal -->
<div id="pairingSelectorModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2 id="pairingSelectorTitle">Select Item to Pair</h2>
            <button class="close-btn" id="closePairingSelectorBtn">×</button>
        </div>
        <div class="modal-body">
            <div style="margin-bottom:16px">
                <div class="search-wrapper">
                    <label for="pairingSearchInput" class="visually-hidden">Search items to pair</label>
                    <input id="pairingSearchInput" type="text" placeholder="Search items to pair..."/>
                    <button class="barcode-btn" id="pairingBarcodeScanBtn" title="Scan barcode">
                        <img src="icons/barcode.png" alt="Scan barcode" />
                    </button>
                </div>
            </div>
            <div id="pairingItemsList" class="list" style="max-height:400px;overflow-y:auto"></div>
            <div class="muted" style="margin-top:8px;text-align:center" id="pairingStatus"></div>
        </div>
        <div class="modal-footer">
            <div class="row" style="margin:0">
                <button class="btn" id="cancelPairingSelectorBtn">Cancel</button>
            </div>
        </div>
    </div>
</div>

<!-- Main Application JavaScript Module -->
<script type="module" src="js/app.js"></script>
</body>
</html>
